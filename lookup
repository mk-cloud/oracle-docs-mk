CREATE OR REPLACE FUNCTION xxar_get_sii_country_code (
    p_meaning IN VARCHAR2
) RETURN VARCHAR2
IS
    l_lookup_code VARCHAR2(30);
BEGIN
    SELECT lookup_code
    INTO   l_lookup_code
    FROM   fnd_lookup_values
    WHERE  lookup_type = 'XXAR_SII_COUNNTRY_CODE'
    AND    meaning = p_meaning
    AND    language = USERENV('LANG')
    AND    enabled_flag = 'Y'
    AND    SYSDATE BETWEEN NVL(start_date_active, SYSDATE - 1)
                       AND NVL(end_date_active, SYSDATE + 1);
    
    RETURN l_lookup_code;
    
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        RETURN NULL;
    WHEN TOO_MANY_ROWS THEN
        RETURN NULL;
    WHEN OTHERS THEN
        RETURN NULL;
END xxar_get_sii_country_code;
/


SELECT xxar_get_sii_country_code('SN') AS country_code FROM DUAL;
